<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Gallery Animation Demo</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Manrope');

        :root {
          font-size: clamp(1.5rem, 2vw + 1rem, 2.5rem);
          --clr-bg: #020617;
          --clr-text: #fff;
          --clr-primary: #fff;
          
          /* Enhanced 3D effect parameters */
          --hover-intensity: 15rem;
          --hover-smoothness: 50ms; 
          --fall-smoothness: 400ms;
          --perspective: 2500px;
          --tilt-angle: 55deg;
          --brightness-min: 0.4;
          --brightness-max: 1.3;
        }
        
        /* Mobile/tablet responsive adjustments */
        @media (max-width: 768px) {
          :root {
            --hover-intensity: 8rem;
            --tilt-angle: 35deg;
            --perspective: 1500px;
          }
        }
        
        @media (hover: none) {
          /* Touch devices: simpler effects */
          :root {
            --hover-intensity: 5rem;
            --tilt-angle: 20deg;
            --hover-smoothness: 200ms;
            --fall-smoothness: 300ms;
          }
        }

        body {
          height: 100svh;
          display: grid;
          place-items: center;
          font-family: "Manrope", sans-serif;
          background: var(--clr-bg);
          color: var(--clr-text);
          overflow: hidden;
          padding: 2em;
        }

        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        nav {  
          /* region */
          --r: calc(var(--max-z) * (var(--p) - 1) + var(--z)); 
          
          /* normalized [0-1]*/
          --r-n: calc(
            (var(--r) - 1) / (var(--max-z) * var(--max-p) - 1)
          );
          
          block-size: min(8rem, 100%);
          inline-size: min(30rem, 100%);

          display: flex;
          align-items: flex-end;
          position: relative;
          
          perspective: var(--perspective);
          transform-style: preserve-3d;
          
          --dir: 0deg;
        }

        @media (max-width: 40rem) {
          nav {
            writing-mode: sideways-rl;
            --dir: -90deg;
          }
        }

        a {  
          flex: 1;
          block-size: 100%;
          position: relative;
          display: flex;
          justify-content: center;
          align-items: center;
          color: inherit;
          font-size: 1rem;
          cursor: pointer;
          transform-style: preserve-3d;
          z-index: 1;
          will-change: transform, filter, flex, z-index;
          
          --ts: calc(
            var(--hover-smoothness) * var(--falloff) +
            var(--fall-smoothness) * (1 - var(--falloff))
          );
          
          --fs: calc(
            .15s * var(--falloff,0) +
            .5s * (1 - var(--falloff,0))
          );
          
          transition: 
            scale var(--op, .2s) cubic-bezier(0.34, 1.56, 0.64, 1),
            filter var(--fs) ease-out,
            transform var(--ts, var(--fall-smoothness)) cubic-bezier(0.25, 0.46, 0.45, 0.94),
            flex .4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
            z-index 0s
          ;
        }

        a:hover {
          z-index: 100;
          scale: 1.02;
        }
        
        a:active {
          scale: 1.05;
          --op: .1s;
        }

        a {
          --p-n: calc(var(--i) / (var(--max-p) - 1));
          --diff: calc(var(--p-n) - var(--r-n));  
          --u: calc(abs(var(--diff)) / var(--w)); 
          
          --w: .35;
          --falloff: clamp(calc(0.5 * (1 + cos(min(var(--u), 1) * 180deg))), 0, 1);
          
          --tilt: calc(clamp(-1,var(--diff) * 5, 1) * var(--falloff) * var(--tilt-angle));
          
          transform: 
            translateZ(calc(var(--falloff) * var(--hover-intensity)))
            rotateY(calc(var(--tilt) * cos(var(--dir))))
            rotateX(calc(var(--tilt) * sin(var(--dir))))
            scale(calc(1 + var(--falloff) * 0.05))
          ;
          
          filter: 
            brightness(clamp(var(--brightness-min), var(--falloff) * var(--brightness-max), var(--brightness-max)))
            saturate(calc(0.3 + var(--falloff) * 0.7))
            contrast(calc(0.9 + var(--falloff) * 0.2))
          ;
        }

        .img {
          background: var(--img);
          background-color: #fff3;
          background-size: cover;
          background-position: center;
          width: 100%;
          height: 100%;
          margin-inline: 0.1em;
          border-radius: 8px;
          box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
          transition: box-shadow 0.3s ease;
        }
        
        a:hover .img {
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .hover-zone {
          position: absolute;
          inset: 0;
          inset-inline: -3px;
          display: flex;
          z-index: 999;
        }

        .hover-zone > i {
          flex: 1;
          transition: .3s;
        }

        .hover-zone::after {
          position: absolute;
          inset: 0;
        }

        .hover-zone:active::after, 
        .hover-zone:hover:not(:has(> i:hover))::after,
        a:focus-visible .hover-zone::after {
          content: '';
          pointer-events: all;
          --o: 1;
        }

        nav:has(.hover-zone:hover):not(:has(i:hover)), 
        nav:has(a:focus-visible) {
          --z: calc((var(--max-z) + 1) / 2);
        }

        nav:has(.hover-zone:hover):not(:has(i:hover)) a:hover, 
        nav:has(a:focus-visible) a:focus-visible {
          flex: 5;
        }
        
        /* Smooth expansion of neighboring images */
        nav:has(.hover-zone:hover):not(:has(i:hover)) a:not(:hover) {
          flex: 0.7;
        }

        /* Focus on tab navigation */
        a:nth-child(1):is(:hover,:focus-visible) ~ * { --p: 1; }
        nav:has(:nth-child(1 of a):is(:hover,:focus-visible)) {--p: 1;}
        nav:has(:nth-child(2 of a):is(:hover,:focus-visible)) {--p: 2;}
        nav:has(:nth-child(3 of a):is(:hover,:focus-visible)) {--p: 3;}
        nav:has(:nth-child(4 of a):is(:hover,:focus-visible)) {--p: 4;}
        nav:has(:nth-child(5 of a):is(:hover,:focus-visible)) {--p: 5;}
        nav:has(:nth-child(6 of a):is(:hover,:focus-visible)) {--p: 6;}
        nav:has(:nth-child(7 of a):is(:hover,:focus-visible)) {--p: 7;}

        nav:has(.hover-zone > i:nth-child(1):hover) {--z: 1;}
        nav:has(.hover-zone > i:nth-child(2):hover) {--z: 2;}
        nav:has(.hover-zone > i:nth-child(3):hover) {--z: 3;}
        nav:has(.hover-zone > i:nth-child(4):hover) {--z: 4;}
        nav:has(.hover-zone > i:nth-child(5):hover) {--z: 5;}
        nav:has(.hover-zone > i:nth-child(6):hover) {--z: 6;}
        nav:has(.hover-zone > i:nth-child(7):hover) {--z: 7;}
    </style>
</head>
<body>
    <nav style="--max-p: 7; --max-z: 7; --p: 1; --z: 1;">
        <a href="#" style="--i: 0;">
            <div class="img" style="--img: url('images/IMG_0913 2.JPG');"></div>
        </a>
        <a href="#" style="--i: 1;">
            <div class="img" style="--img: url('images/IMG_1505 2.JPG');"></div>
        </a>
        <a href="#" style="--i: 2;">
            <div class="img" style="--img: url('images/IMG_1672 2.JPG');"></div>
        </a>
        <a href="#" style="--i: 3;">
            <div class="img" style="--img: url('images/IMG_2618 2.JPG');"></div>
        </a>
        <a href="#" style="--i: 4;">
            <div class="img" style="--img: url('https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1200&h=1800&fit=crop&q=90');"></div>
        </a>
        <a href="#" style="--i: 5;">
            <div class="img" style="--img: url('https://images.unsplash.com/photo-1448375240586-882707db888b?w=1200&h=1800&fit=crop&q=90');"></div>
        </a>
        <a href="#" style="--i: 6;">
            <div class="img" style="--img: url('https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=1200&h=600&fit=crop&q=95');"></div>
        </a>
        
        <div class="hover-zone">
            <i></i>
            <i></i>
            <i></i>
            <i></i>
            <i></i>
            <i></i>
            <i></i>
        </div>
    </nav>

    <script>
        const nav = document.querySelector('nav');
        const hoverZone = document.querySelector('.hover-zone');
        const items = document.querySelectorAll('.hover-zone > i');
        const links = document.querySelectorAll('nav > a');
        
        // Detect touch vs mouse
        const isTouchDevice = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
        
        // Track mouse position over hover zones
        items.forEach((item, index) => {
            item.addEventListener('mouseenter', () => {
                nav.style.setProperty('--z', index + 1);
            });
        });
        
        // Track which image is being hovered
        links.forEach((link, index) => {
            link.addEventListener('mouseenter', () => {
                nav.style.setProperty('--p', index + 1);
            });
            
            // Touch support: tap to expand/focus
            if (isTouchDevice) {
                link.addEventListener('touchstart', (e) => {
                    // Remove focus from all others
                    links.forEach(l => l.classList.remove('touch-active'));
                    link.classList.add('touch-active');
                    
                    nav.style.setProperty('--p', index + 1);
                    nav.style.setProperty('--z', Math.floor(items.length / 2) + 1);
                }, { passive: true });
            }
        });
        
        // Reset on mouse leave
        nav.addEventListener('mouseleave', () => {
            nav.style.setProperty('--p', 1);
            nav.style.setProperty('--z', 1);
        });
        
        // Enhanced smooth animation loop for hover tracking
        let currentP = 1;
        let currentZ = 1;
        let targetP = 1;
        let targetZ = 1;
        
        function smoothUpdate() {
            const pValue = parseFloat(nav.style.getPropertyValue('--p')) || 1;
            const zValue = parseFloat(nav.style.getPropertyValue('--z')) || 1;
            
            // Smooth interpolation
            currentP += (pValue - currentP) * 0.15;
            currentZ += (zValue - currentZ) * 0.15;
            
            nav.style.setProperty('--p', currentP);
            nav.style.setProperty('--z', currentZ);
            
            requestAnimationFrame(smoothUpdate);
        }
        
        // Start smooth animation (optional - creates buttery smooth transitions)
        // Uncomment if you want even smoother motion:
        // smoothUpdate();
    </script>
</body>
</html>
